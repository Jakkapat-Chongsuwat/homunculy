# =============================================================================
# SecretProviderClass Patch - Production Values
# =============================================================================
# Uses kubelet managed identity with explicit client ID
# Required because AKS creates both system and kubelet identities
# =============================================================================
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: azure-keyvault-homunculy
spec:
  parameters:
    usePodIdentity: "false"
    useVMManagedIdentity: "true"
    userAssignedIdentityID: "8f6777fb-b3cf-46d7-b675-74ea9a6a8d3b"  # kubelet identity
    keyvaultName: "kv-homunculy-prod"
    tenantId: "d52cd61e-40d3-463c-a422-f4aa5017abd5"
